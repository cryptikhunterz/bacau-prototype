# Codebase Structure

**Analysis Date:** 2026-01-09

## Directory Layout

```
shape-graph-animation/
├── app.py                          # PRIMARY: Streamlit web UI (1,470 lines)
├── main.py                         # SECONDARY: Desktop UI wrapper (43 lines)
├── requirements.txt                # Python dependencies
├── README.md                       # User documentation
├── IMPLEMENTATION_PLAN.md          # Development roadmap
├── Procfile                        # Railway deployment
│
├── src/                            # Core modules (2,062 lines)
│   ├── __init__.py
│   ├── ui.py                       # Tkinter UI wrapper
│   ├── animate.py                  # Animation/video export
│   ├── visualize.py                # Frame visualization
│   ├── pitch.py                    # Pitch rendering
│   ├── markers.py                  # Player markers
│   ├── shape_lines.py              # Convex hull rendering
│   ├── position_classifier.py      # Formation detection
│   ├── compactness.py              # Compactness Index (CI)
│   ├── data_loader.py              # Data loading utilities
│   ├── colors.py                   # Color constants
│   ├── time_utils.py               # Frame-to-time conversion
│   └── activity_logger.py          # Logging system
│
├── docs/                           # Technical documentation
│   └── technical/                  # Sub-documents
│
├── Fifa world cup 2022 data/       # PFF dataset
│   ├── Metadata/                   # Game metadata JSON
│   ├── Rosters/                    # Player rosters JSON
│   ├── Tracking Data/              # Tracking .jsonl.bz2
│   └── Event Data/                 # Event JSON
│
├── data/                           # Additional data (legacy)
├── logs/                           # Runtime logs
├── outputs/                        # Generated animations
├── .streamlit/                     # Streamlit config
├── venv/                           # Virtual environment
└── .git/                           # Git repository
```

## Directory Purposes

**src/**
- Purpose: Core application modules
- Contains: Python modules for visualization, analysis, utilities
- Key files: `compactness.py` (336 lines), `position_classifier.py` (150 lines)
- Subdirectories: None (flat structure)

**docs/**
- Purpose: Technical documentation
- Contains: Architecture docs, integration guides, deployment docs
- Key files: `pff_data_integration.md`, `railway_deployment.md`
- Subdirectories: `technical/` for detailed docs

**Fifa world cup 2022 data/**
- Purpose: PFF World Cup 2022 tracking data
- Contains: JSON/JSONL.bz2 files for 16 matches
- Key files: Game 3821 (Germany vs Japan) is default
- Subdirectories: `Metadata/`, `Rosters/`, `Tracking Data/`, `Event Data/`

## Key File Locations

**Entry Points:**
- `app.py` - Main Streamlit application
- `main.py` - Desktop UI launcher

**Configuration:**
- `requirements.txt` - Python dependencies
- `.streamlit/config.toml` - Streamlit settings
- `Procfile` - Railway deployment

**Core Logic:**
- `src/compactness.py` - Compactness Index calculation
- `src/position_classifier.py` - Formation detection
- `src/shape_lines.py` - Convex hull computation

**Testing:**
- Embedded in modules (`if __name__ == "__main__":` blocks)
- `src/compactness.py` lines 200-335 - 10 test cases

**Documentation:**
- `README.md` - User documentation
- `docs/pff_data_integration.md` - Data format guide
- `docs/shape_graph_architecture.md` - System design

## Naming Conventions

**Files:**
- snake_case.py for all Python modules
- UPPERCASE.md for important docs (README, IMPLEMENTATION_PLAN)
- kebab-case.md for technical docs

**Directories:**
- lowercase for all directories
- Plural for collections (`docs/`, `logs/`, `outputs/`)

**Special Patterns:**
- `__init__.py` for package marker (empty)
- `config.toml` in `.streamlit/` for Streamlit settings

## Where to Add New Code

**New Feature Module:**
- Primary code: `src/{feature_name}.py`
- Tests: Inline `if __name__ == "__main__":` block
- Integration: Import in `app.py`

**New Visualization:**
- Implementation: `src/{viz_name}.py`
- Colors: Add to `src/colors.py`
- Integration: Call from `app.py` render functions

**New Metric/Analysis:**
- Implementation: `src/{metric_name}.py`
- Pattern: Follow `src/compactness.py` structure
- Tests: Add test cases at module bottom

**New Data Source:**
- Implementation: `src/data_loader.py` (extend)
- Integration: Add loader function like `load_pff_tracking()`

**Utilities:**
- Shared helpers: `src/` (new module or extend existing)
- Constants: `src/colors.py` or new `src/constants.py`

## Special Directories

**venv/**
- Purpose: Python virtual environment
- Source: Created by `python -m venv venv`
- Committed: No (in .gitignore)

**__pycache__/**
- Purpose: Python bytecode cache
- Source: Auto-generated by Python
- Committed: No (in .gitignore)

**logs/**
- Purpose: Runtime activity logs
- Source: Generated by `ActivityLogger`
- Committed: Partially (may contain example logs)

**outputs/**
- Purpose: Generated animation files
- Source: `src/animate.py` exports
- Committed: No (generated artifacts)

---

*Structure analysis: 2026-01-09*
*Update when directory structure changes*
